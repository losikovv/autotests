plugins {
    id 'java'
    id 'io.qameta.allure' version '2.8.1'
}

apply from: 'dependencies.gradle'
apply from: 'variables.gradle'

apply from: 'task.gradle'
apply from: 'ui-task.gradle'
apply from: 'api-task.gradle'

allprojects {
    repositories {
        mavenCentral()
        mavenLocal()
    }
}

subprojects {
    apply plugin: 'java'
    apply plugin: 'idea'

    sourceCompatibility = JavaVersion.VERSION_11
    targetCompatibility = JavaVersion.VERSION_11

    [compileJava, compileTestJava]*.options*.encoding = 'UTF-8'

    sourceSets {
        main {
            java {
                srcDirs = ['src/main/java']
            }
            resources {
                srcDirs = ['src/main/resources']
            }
        }
    }
}

allure {
    version = versions.allure
    autoconfigure = true
    aspectjweaver = true
    allureJavaVersion = versions.allure
    configuration = "testImplementation"
    useTestNG(){
        version = versions.allure
    }
    downloadLink = "https://repo.maven.apache.org/maven2/io/qameta/allure/allure-commandline/"+versions.allure+"/allure-commandline-"+versions.allure+".zip"
}

dependencies {
    implementation project(":qase-api")

    implementation lib.aspectjweaver
    implementation lib.restAssured
    implementation lib.allureRestAssuredReport
    implementation lib.allureTestng
    implementation lib.allureJavaCommons
    compileOnly lib.lombok
    implementation lib.seleniumChromeDriver
    implementation lib.restAssuredSchemaValidator
    implementation lib.testng
    implementation lib.seleniumJava
    implementation lib.jsonSimple
    annotationProcessor lib.lombok
    testImplementation lib.logback
    testCompileOnly lib.lombok
    testAnnotationProcessor lib.lombok
}

project(":ui") {

}

project(":qase-api") {
    apply plugin: "java-library"

    dependencies {
        implementation lib.allureJavaCommons
        implementation lib.lombok
        implementation lib.jsonSimple
        implementation lib.konghq
        testImplementation lib.logback
        annotationProcessor lib.lombok
    }
}
